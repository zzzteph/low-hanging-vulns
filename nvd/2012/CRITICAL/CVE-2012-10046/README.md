# CVE-2012-10046

**2025-08-08 19:15:34**

## Description
The E-Mail Security Virtual Appliance (ESVA) (tested on version ESVA_2057) contains an unauthenticated command injection vulnerability in the learn-msg.cgi script. The CGI handler fails to sanitize user-supplied input passed via the id parameter, allowing attackers to inject arbitrary shell commands. Exploitation requires no authentication and results in full command execution on the underlying system.

![](https://img.shields.io/static/v1?label=Score&message=9.3&color=red)
![](https://img.shields.io/static/v1?label=Severity&message=CRITICAL&color=red)
![](https://img.shields.io/static/v1?label=CWE&message=RCE&color=green)

## Links
- [https://raw.githubusercontent.com/rapid7/metasploit-framework/master/modules/exploits/linux/http/esva_exec.rb](https://raw.githubusercontent.com/rapid7/metasploit-framework/master/modules/exploits/linux/http/esva_exec.rb)
- [https://sourceforge.net/projects/esva-project/](https://sourceforge.net/projects/esva-project/)
- [https://www.exploit-db.com/exploits/20551](https://www.exploit-db.com/exploits/20551)
- [https://www.exploit-db.com/exploits/20712](https://www.exploit-db.com/exploits/20712)
- [https://www.vulncheck.com/advisories/email-security-virtual-appliance-command-injection](https://www.vulncheck.com/advisories/email-security-virtual-appliance-command-injection)
- [https://raw.githubusercontent.com/rapid7/metasploit-framework/master/modules/exploits/linux/http/esva_exec.rb](https://raw.githubusercontent.com/rapid7/metasploit-framework/master/modules/exploits/linux/http/esva_exec.rb)
- [https://www.exploit-db.com/exploits/20551](https://www.exploit-db.com/exploits/20551)
- [https://www.exploit-db.com/exploits/20712](https://www.exploit-db.com/exploits/20712)
